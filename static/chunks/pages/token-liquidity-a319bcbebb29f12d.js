(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[758],{5237:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/token-liquidity",function(){return t(51728)}])},51728:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return V},default:function(){return Y}});var o=t(26042),r=t(69396),i=t(85893),a=t(67294),l=t(11163),s=t(68527),u=t(79762),c=t(26723),d=t(81072),h=t(47787),f=t(53545),m=t(36911),p=t(828),v=t(7297),g=t(29815),x=t(5152),k=t.n(x),T=t(92506),y=t(70794),b=t(7983),w=t(64971),j=t(80918),P=t(45169),Z=t(47568),N=t(70655),C=t(17e3),S=t(87669),q=t(4385),D=t(9279);function I(e){var n,t,i=e.routes,a=e.gasPriceData,l=e.gasTokenPrice,s=e.fromToken,u=e.toToken,c=e.toTokenPrice,d=i.map((function(e){if(e.price){var n,t,i=e.price.estimatedGas&&(null===a||void 0===a||null===(n=a.formatted)||void 0===n?void 0:n.gasPrice)&&l?l*+e.price.estimatedGas*+(null===a||void 0===a||null===(t=a.formatted)||void 0===t?void 0:t.gasPrice)/1e18:0;i=e.price.feeAmount&&s.address===D.d?Number(e.price.feeAmount)/1e18*l:i;var d=+(+e.price.amountReturned/Math.pow(10,+(null===u||void 0===u?void 0:u.decimals))*c).toFixed(2)-i;return(0,r.Z)((0,o.Z)({},e),{netOut:d})}return(0,r.Z)((0,o.Z)({},e),{netOut:0})})).sort((function(e,o){return Number(null!==(n=o.netOut)&&void 0!==n?n:0)-Number(null!==(t=e.netOut)&&void 0!==t?t:0)}));return d.length>0?d[0]:null}function _(){return(_=(0,Z.Z)((function(e){var n,t,i,a,l,s,u,c,d,f;return(0,N.__generator)(this,(function(m){switch(m.label){case 0:if(n=e.chain,t=e.fromToken,i=e.toToken,a=e.gasPriceData,l=e.fromTokenPrice,s=e.toTokenPrice,u=e.gasTokenPrice,!t||!n||!i||!a||!l||!s||!u)return[2,[]];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Promise.allSettled(h.pi.map((function(e){return F({chain:n,fromToken:(0,r.Z)((0,o.Z)({},t),{value:t.address,label:t.symbol}),toToken:i,amount:e,fromTokenPrice:l,gasPriceData:a})})))];case 2:return c=m.sent(),d=[],c.forEach((function(e){if("fulfilled"===e.status){var n=(0,p.Z)(e.value,2),o=n[0],r=I({routes:n[1],gasPriceData:a,gasTokenPrice:u,fromToken:t,toToken:i,toTokenPrice:s});d.push([Number(o),r])}})),[2,d];case 3:return f=m.sent(),console.log(f),[2,[]];case 4:return[2]}}))}))).apply(this,arguments)}function M(){return(M=(0,Z.Z)((function(e){var n,t,i,a,l,s,u,c,d,h,f,m;return(0,N.__generator)(this,(function(v){switch(v.label){case 0:n=e.chain,t=e.fromToken,i=e.toToken,a=e.gasPriceData,l=e.fromTokenPrice,s=e.toTokenPrice,u=e.gasTokenPrice,c=e.amount,v.label=1;case 1:return v.trys.push([1,3,,4]),t&&n&&i&&a&&l&&s&&u&&c?[4,F({chain:n,fromToken:(0,r.Z)((0,o.Z)({},t),{value:t.address,label:t.symbol}),toToken:i,amount:c,fromTokenPrice:l,gasPriceData:a})]:[2,[c,null]];case 2:return d=p.Z.apply(void 0,[v.sent(),2]),h=d[1],f=I({routes:h,gasPriceData:a,gasTokenPrice:u,fromToken:t,toToken:i,toTokenPrice:s}),[2,[c,f]];case 3:return m=v.sent(),console.log(m),[2,[c,null]];case 4:return[2]}}))}))).apply(this,arguments)}function F(e){return L.apply(this,arguments)}function L(){return(L=(0,Z.Z)((function(e){var n,t,o,r,i,a,l,s,u,c;return(0,N.__generator)(this,(function(d){switch(d.label){case 0:n=e.chain,t=e.fromToken,o=e.toToken,r=e.amount,i=e.fromTokenPrice,a=e.gasPriceData,d.label=1;case 1:return d.trys.push([1,3,,4]),l=(0,y.Z)((0,y.Z)(r).times((0,y.Z)(1).div(i))).times(Math.pow(10,(null===t||void 0===t?void 0:t.decimals)||18)).toFixed(0),[4,Promise.allSettled(m.j$.filter((function(e){return e.chainToId[n]})).map((function(e){return(0,q.Y)({adapter:e,chain:n,from:null===t||void 0===t?void 0:t.value,to:null===o||void 0===o?void 0:o.value,amount:l,extra:{gasPriceData:a,amount:r.toString(),fromToken:t,toToken:o,userAddress:D.d}})})))];case 2:return s=d.sent(),u=s.map((function(e){return"fulfilled"===e.status?e.value:null})).filter((function(e){return!!e})),[2,["".concat(r.toString()),u]];case 3:return c=d.sent(),console.log(c),[2,["".concat(r.toString()),[]]];case 4:return[2]}}))}))).apply(this,arguments)}var O=function(e){var n=e.chain,t=e.fromToken,o=e.toToken,r=e.gasTokenPrice,i=e.fromTokenPrice,a=e.toTokenPrice,l=e.gasPriceData;return(0,C.a)(["initialLiquidity",n,null===t||void 0===t?void 0:t.address,null===o||void 0===o?void 0:o.address,r,i,a],(function(){return function(e){return _.apply(this,arguments)}({chain:n,fromToken:t,toToken:o,gasTokenPrice:r,fromTokenPrice:i,toTokenPrice:a,gasPriceData:l})}),{refetchOnMount:!1,refetchInterval:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchIntervalInBackground:!1})},R=function(e){var n,t=e.chain,o=e.fromToken,r=e.toToken,i=e.gasTokenPrice,l=e.fromTokenPrice,s=e.toTokenPrice,u=e.gasPriceData,c=e.liquidity,d=(0,S.h)({queries:c.map((function(e){return{queryKey:["liquidity",e,t,null===o||void 0===o?void 0:o.address,null===r||void 0===r?void 0:r.address,i,l,s],queryFn:function(){return function(e){return M.apply(this,arguments)}({chain:t,fromToken:o,toToken:r,gasTokenPrice:i,fromTokenPrice:l,toTokenPrice:s,gasPriceData:u,amount:e})},refetchOnMount:!1,refetchInterval:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchIntervalInBackground:!1,retry:0,retryOnMount:!1}}))});return{isLoading:!(d.filter((function(e){return"success"===e.status})).length>=1),data:(0,a.useMemo)((function(){return null!==(n=null===d||void 0===d?void 0:d.filter((function(e){return"success"===e.status})).map((function(e){return e.data})))&&void 0!==n?n:[]}),[d])}},W=t(20047);function E(e){var n,t,o,r,i=e.routes,a=e.price,l=e.fromTokenDecimals,s=e.toTokenDecimals,u=e.minimumSlippage,c=e.maximumSlippage,d=a||500,f=null!==(r=null===(n=null===i||void 0===i?void 0:i.find((function(e){return e[0]===d})))||void 0===n||null===(t=n[1])||void 0===t||null===(o=t.price)||void 0===o?void 0:o.amountReturned)&&void 0!==r?r:null,m=[],v=[];f&&(null===i||void 0===i||i.forEach((function(e,n){var t,o=(0,p.Z)(e,2),r=o[0],a=o[1],u=a.name,c=a.price,g=a.fromAmount,x=null!==(t=null===c||void 0===c?void 0:c.amountReturned)&&void 0!==t?t:null;if(x){var k=Number(f)*(Number(r)/d),T=r<d?0:Number(Math.abs((Number(x)-k)/k*100).toFixed(2)),b=m[n-1];if(m.length&&b&&T-b[1]>1){var w=Math.floor((Number(b[0])+Number(r))/2);!v.includes(w)&&!h.pi.includes(w)&&w>500&&w<5e8&&i.length<=100&&v.push(w)}m.push([Number(r),T,Number((0,y.Z)(x).div(Math.pow(10,Number(s||18))).toFixed(3)),u,Number((0,y.Z)(g).div(Math.pow(10,Number(l||18))).toFixed(3))])}})));var g=function(e,n){var t=0,o=e.length-1;for(;t<=o;){var r=Math.floor((t+(o+1))/2);if(e[r][1]>=n&&(!(r>0)||e[r-1][1]<n))return r;n<e[r][1]?o=r-1:t=r+1}return 0}(m,u||0),x=function(e,n){var t=0,o=e.length-1;for(;t<=o;){var r=Math.floor((t+(o+1))/2);if(e[r][1]<=n&&(!(r<e.length-1)||e[r+1][1]>n))return r;n<e[r][1]?o=r-1:t=r+1}return e.length}(m,c||100),k=m.slice(g,x+1);return{chartData:k.filter((function(e,n){return!k[n+1]||e[1]<k[n+1][1]})),newLiquidityValues:v.sort((function(e,n){return e-n}))}}function z(){return(z=(0,Z.Z)((function(e){var n,t,o,r;return(0,N.__generator)(this,(function(i){switch(i.label){case 0:return(n=e.id)?[4,fetch("https://api.coingecko.com/api/v3/simple/price?ids=".concat(n,"&vs_currencies=usd&include_market_cap=true\n    ")).then((function(e){return e.json()}))]:[2,null];case 1:return[2,(o=i.sent())&&null!==(r=null===(t=Object.values(o))||void 0===t?void 0:t[0].usd_market_cap)&&void 0!==r?r:null]}}))}))).apply(this,arguments)}function X(e){var n=e.id;return(0,C.a)(["mcap",n],(function(){return function(e){return z.apply(this,arguments)}({id:n})}),{refetchOnMount:!1,refetchInterval:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchIntervalInBackground:!1})}function A(){var e=(0,v.Z)(["\n\ttable-layout: fixed;\n\twidth: 100%;\n\n\tth,\n\ttd,\n\tcaption {\n\t\tpadding: 4px;\n\t\tfont-size: 1rem;\n\t\tfont-weight: 400;\n\t\ttext-align: center;\n\t\tborder: 1px solid ",";\n\t}\n\n\tcaption {\n\t\tborder-bottom: none;\n\t}\n"]);return A=function(){return e},e}var B=k()((function(){return Promise.all([t.e(764),t.e(576),t.e(494)]).then(t.bind(t,79494))}),{loadableGenerated:{webpack:function(){return[79494]}},ssr:!1});function G(e){var n,t=e.fromToken,c=e.toToken,d=e.chain,f=(0,l.useRouter)(),m=f.query,v=m.minSlippage,x=m.maxSlippage,k=m.showTokenMcap,T="string"!==typeof v||Number.isNaN(Number(v))?0:Number(v),Z="string"!==typeof x||Number.isNaN(Number(x))?0:Number(x),N="true"===k,C=(0,W.R)({chain:d,toToken:null===c||void 0===c?void 0:c.address,fromToken:null===t||void 0===t?void 0:t.address,skipRefetch:!0}),S=C.data,q=C.isLoading,D=O({fromToken:t,toToken:c,chain:d,gasPriceData:null===S||void 0===S?void 0:S.gasPriceData,gasTokenPrice:null===S||void 0===S?void 0:S.gasTokenPrice,fromTokenPrice:null!==(n=null===S||void 0===S?void 0:S.fromTokenPrice)&&void 0!==n?n:0,toTokenPrice:null===S||void 0===S?void 0:S.toTokenPrice}),I=D.data,_=D.isLoading,M=q||_,F=(0,p.Z)(a.useState([]),2),L=F[0],z=F[1],A=R({fromToken:t,toToken:c,chain:d,gasPriceData:null===S||void 0===S?void 0:S.gasPriceData,gasTokenPrice:null===S||void 0===S?void 0:S.gasTokenPrice,fromTokenPrice:null===S||void 0===S?void 0:S.fromTokenPrice,toTokenPrice:null===S||void 0===S?void 0:S.toTokenPrice,liquidity:L}).data,G=a.useMemo((function(){var e;return E({routes:null===(e=(0,g.Z)(I||[]).concat((0,g.Z)(A||[])))||void 0===e?void 0:e.sort((function(e,n){return e[0]-n[0]})),toTokenDecimals:c.decimals,fromTokenDecimals:t.decimals,price:"WBTC"===t.symbol?1e4:500,minimumSlippage:T,maximumSlippage:Z})}),[I,c.decimals,t.decimals,t.symbol,A,T,Z]),U=G.chartData,V=G.newLiquidityValues.filter((function(e){return!L.includes(e)}));V.length&&z((function(e){return(0,g.Z)(e).concat((0,g.Z)(V)).sort((function(e,n){return e-n}))}));var Y=(0,p.Z)(a.useState([0,100]),2),Q=Y[0],$=Y[1],K=X({id:t.geckoId}).data,J=K&&N?Math.round(K):null;return(0,i.jsxs)(s.kC,{flexDir:"column",gap:"24px",children:[(0,i.jsxs)(H,{children:[(0,i.jsx)("caption",{children:(0,i.jsxs)(s.kC,{alignItems:"center",flexWrap:"nowrap",justifyContent:"center",gap:1,children:[(0,i.jsxs)(s.kC,{as:"span",alignItems:"center",gap:"2px",flexWrap:"nowrap",children:[(0,i.jsx)("img",{src:t.logoURI,alt:"",style:{width:"20px",height:"20px",objectFit:"cover",display:" flex",borderRadius:"100%"}}),(0,i.jsx)(s.xu,{as:"span",fontWeight:500,fontSize:16,children:t.symbol})]}),(0,i.jsx)(P.Z,{width:16,height:16,display:"block"}),(0,i.jsxs)(s.kC,{as:"span",alignItems:"center",gap:"2px",flexWrap:"nowrap",children:[(0,i.jsx)("img",{src:c.logoURI,alt:"",style:{width:"20px",height:"20px",objectFit:"cover",display:" flex"}}),(0,i.jsx)(s.xu,{as:"span",fontWeight:500,fontSize:16,children:c.symbol})]})]})}),(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Trade"}),(0,i.jsx)("th",{children:"Receive"})]})}),(0,i.jsx)("tbody",{children:h.pi.map((function(e){var n,o,r,a,l,s=null!==(a=null===(n=null===I||void 0===I?void 0:I.find((function(n){return n[0]===e})))||void 0===n?void 0:n[1])&&void 0!==a?a:null;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"$".concat(e.toLocaleString()," of ").concat(t.symbol)}),(0,i.jsx)("td",{children:M?(0,i.jsx)(b.Od,{height:"16px",width:"100%",maxWidth:"24ch",margin:"auto"}):(0,i.jsx)(i.Fragment,{children:(null===s||void 0===s||null===(o=s.price)||void 0===o?void 0:o.amountReturned)?"".concat(Number((0,y.Z)(null!==(l=null===s||void 0===s||null===(r=s.price)||void 0===r?void 0:r.amountReturned)&&void 0!==l?l:0).div(Math.pow(10,Number(c.decimals||18))).toFixed(3)).toLocaleString()," ").concat(c.symbol," via ").concat(null===s||void 0===s?void 0:s.name):""})})]},c.address+e)}))})]}),(0,i.jsx)(s.xu,{minH:"745px",children:U.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.kC,{alignItems:"center",justifyContent:"space-between",gap:"16px",flexWrap:"wrap",margin:"24px 32px 24px auto",w:"full",children:[(0,i.jsxs)(u.NI,{display:"flex",alignItems:"center",gap:"8px",w:"fit-content",children:[t.geckoId&&(0,i.jsx)(w.r,{id:"coinMcap",checked:N,onChange:function(){f.push({pathname:f.pathname,query:(0,r.Z)((0,o.Z)({},f.query),{showTokenMcap:!N})},void 0,{shallow:!0})}}),(0,i.jsx)(u.lX,{htmlFor:"coinMcap",mb:"0",children:"Show % of ".concat(t.symbol," Mcap")})]}),(0,i.jsxs)(s.kC,{as:"form",alignItems:"center",flexDir:"row",gap:"20px",width:"100%",maxW:"360px",children:[(0,i.jsx)(s.xv,{as:"label",whiteSpace:"nowrap",children:"Slippage Range"}),(0,i.jsxs)(j.U2,{"aria-label":["min slippage","max slippage"],min:0,max:100,defaultValue:[0,100],step:1,onChange:function(e){return $(e)},onChangeEnd:function(e){f.push({pathname:f.pathname,query:(0,r.Z)((0,o.Z)({},f.query),{minSlippage:e[0],maxSlippage:e[1]})},void 0,{shallow:!0})},children:[(0,i.jsxs)(j.Qp,{value:Q[0],textAlign:"center",color:"white",mt:"-8",ml:"-5",w:"12",children:[Q[0],"%"]}),(0,i.jsxs)(j.Qp,{value:Q[1],textAlign:"center",color:"white",mt:"-8",ml:"-5",w:"12",children:[Q[1],"%"]}),(0,i.jsx)(j.ug,{children:(0,i.jsx)(j.I2,{bg:"#2563eb"})}),(0,i.jsx)(j.xW,{index:0}),(0,i.jsx)(j.xW,{index:1})]})]})]}),(0,i.jsx)(s.xu,{height:"400px",children:(0,i.jsx)(B,{chartData:U,fromTokenSymbol:t.symbol,toTokenSymbol:c.symbol,mcap:J})}),(0,i.jsxs)(s.kC,{flexDir:"column",gap:"20px",marginY:"36px",children:[(0,i.jsx)(s.xv,{as:"p",fontSize:"1rem",children:"This tool gets price quotes on 10 different dex aggregators at different levels and displays the results over a chart, so the resulting data aggregates all liquidity across the hundreds of dexs that all those aggregators have integrated, including stuff like limit orders, thus we are quite confident that this will accurately report all on-chain liquidity."}),(0,i.jsx)(s.xv,{as:"p",fontSize:"1rem",children:"You can use this tool to find out how much needs to be sold to cause a price drop of 10%, 20%... or just to see how deep the liquidity is for a given token. It'll be especially useful for defi risk teams."}),(0,i.jsx)(s.xv,{as:"p",fontSize:"1rem",children:"The chart will keep updating with more data as long as this window is open, so if you want your chart to be more granular just wait for a bit, you'll notice how the chart adjust in real time."}),(0,i.jsx)(s.xv,{as:"p",fontSize:"1rem",children:"There's currently a bug that causes spikes to be formed if you switch to a different tab while the chart is being created, so please avoid doing that."})]})]})})]})}var H=T.ZP.table.withConfig({componentId:"sc-e0199e8e-0"})(A(),(function(e){return e.theme.bg3})),U=(0,m.Mk)(),V=!0;function Y(e){var n=e.tokenlist,t=(0,l.useRouter)(),m=t.query,p=m.chain,v=m.from,g=m.to,x="string"===typeof p?p.toLowerCase():"ethereum",k="string"===typeof v?v.toLowerCase():null,T="string"===typeof g?g.toLowerCase():null,y=a.useMemo((function(){var e=n&&x?n[h.zk[x]]||[]:null,t=U.find((function(e){return e.value===x})),i=null===e||void 0===e?void 0:e.find((function(e){return e.symbol.toLowerCase()===k||e.address.toLowerCase()===k})),a=null===e||void 0===e?void 0:e.find((function(e){return e.symbol.toLowerCase()===T||e.address.toLowerCase()===T}));return{selectedChain:t,selectedFromToken:i?(0,r.Z)((0,o.Z)({},i),{label:i.symbol,value:i.address}):null,selectedToToken:a?(0,r.Z)((0,o.Z)({},a),{label:a.symbol,value:a.address}):null,chainTokenList:e}}),[x,k,T,n]),b=y.selectedChain,w=y.selectedFromToken,j=y.selectedToToken,Z=y.chainTokenList;return(0,i.jsxs)(d.Z,{title:"Token Liquidity - LlamaSwap",defaultSEO:!0,children:[(0,i.jsx)(s.X6,{alignSelf:"center",children:"Token Liquidity"}),(0,i.jsxs)(s.kC,{flexDir:"column",gap:"20px",marginTop:"40px",maxW:"48rem",w:"100%",marginX:"auto",children:[(0,i.jsxs)(u.NI,{display:"flex",flexDirection:"column",justifyContent:"center",children:[(0,i.jsx)(u.lX,{htmlFor:"privacy-switch",pb:"0",lineHeight:1,children:"Chain"}),(0,i.jsx)(f.Z,{options:U,value:b,onChange:function(e){t.push({pathname:t.pathname,query:(0,r.Z)((0,o.Z)({},t.query),{chain:e.value})},void 0,{shallow:!0})},style:{flex:1}})]}),(0,i.jsxs)(s.kC,{gap:"16px",alignItems:"center",children:[(0,i.jsxs)(u.NI,{display:"flex",flexDirection:"column",justifyContent:"center",children:[(0,i.jsx)(u.lX,{htmlFor:"privacy-switch",pb:"0",lineHeight:1,children:"From"}),(0,i.jsx)(f.Z,{options:Z,value:w,onChange:function(e){t.push({pathname:t.pathname,query:(0,r.Z)((0,o.Z)({},t.query),{from:e.symbol})},void 0,{shallow:!0})},style:{flex:1}})]}),(0,i.jsx)(c.hU,{onClick:function(){return t.push({pathname:t.pathname,query:(0,r.Z)((0,o.Z)({},t.query),{to:v,from:g})},void 0,{shallow:!0})},bg:"none",icon:(0,i.jsx)(P.Z,{}),"aria-label":"Switch Tokens",marginTop:"auto"}),(0,i.jsxs)(u.NI,{display:"flex",flexDirection:"column",justifyContent:"center",children:[(0,i.jsx)(u.lX,{htmlFor:"privacy-switch",pb:"0",lineHeight:1,children:"To"}),(0,i.jsx)(f.Z,{options:Z,value:j,onChange:function(e){t.push({pathname:t.pathname,query:(0,r.Z)((0,o.Z)({},t.query),{to:e.symbol})},void 0,{shallow:!0})},style:{flex:1}})]})]})]}),b&&w&&j&&(0,i.jsx)(G,{fromToken:w,toToken:j,chain:x})]})}}},function(e){e.O(0,[662,848,441,552,320,492,774,888,179],(function(){return n=5237,e(e.s=n);var n}));var n=e.O();_N_E=n}]);